[.text-center]
= Documentation technique


== Version 2
08/06/2022


[.text-right]

==== _eleves groupe 2A3 :_ +
_Prochaska Oryann +
Babel Teddy +
Sekoub Walaedine +
Hu Shiyu_


[.text-center]
==== SAE Bank S2 05 +
Analyse besoins entreprise +
Dossier de gestion de projet +
Etude economique



<<<


== SOMMAIRE 
. Présentation générale, rôle de l'application +
. Installation utilisation +
. Fonctionnement +
. Résultats produits avec jeux d'essai commentés

<<<

=== Présentation générale, rôle de l'application

====
image::USC.PNG[]
Bienvenue sur l'application _DailyBank_ v1, une version amélioré. +
Dans cette nouvelle version nous y avons inclus plusieurs nouvelles fonctionnalités à savoir : +

#Générer# un relevé mensuel d'un compte en PDF +
#Gérer# les prélèvements automatiques +
#Effectuer# un Débit exceptionnel +
#Simuler# un emprunt +
#Simuler# une assurance d'emprunt +


Cette application est néanmoins toujours destinée aux guichetiers ainsi qu'aux chefs d'agences.






====

=== Installation et utilisation
====
* Execution avec un double clic sur le fichier avec l'extension .jar ou bien après une extraction du fichier compressé. +
* Une connexion à un compte chef d'agence est nécessaire pour simuler un emprunt et une assurance d'emprunt. +
* Un guichetier peut générer un relevé mensuel d'un compte et gérer les prélèvements automatiques. +


#_Seul le chef de l'agence peut rendre un compte inactif_#


====

=== Fonctionnement
====   Partie du use case mis en oeuvre
====
====Fonctionnement pour le Guichetier


====Fonctionnement pour le Chef d'Agence

====


=== Résultats produits avec jeux d'essai commentés +
====
Permet de crée un Compte Courant(Fonction mis en place par Walaedine Sekoub) +

----
	//Crée un nouveau Compte. +
	public CompteCourant creerCompte() {
		CompteCourant compte;
		CompteEditorPane cep = new CompteEditorPane(this.primaryStage, this.dbs);
		compte = cep.doCompteEditorDialog(this.clientDesComptes, null, EditionMode.CREATION);
		if (compte != null) {
			try {
				AccessCompteCourant ac= new AccessCompteCourant();
				ac.insertNewCompteCourant(compte.debitAutorise, compte.solde, this.clientDesComptes.idNumCli);
				
				// TODO : enregistrement du nouveau compte en BDD (la BDD donne de nouvel id
				// dans "compte")

				// if JAMAIS vrai
				// existe pour compiler les catchs dessous
				if (Math.random() < -1) {
					throw new ApplicationException(Table.CompteCourant, Order.INSERT, "todo : test exceptions", null);
				}
			} catch (DatabaseConnexionException e) {
				ExceptionDialog ed = new ExceptionDialog(this.primaryStage, this.dbs, e);
				ed.doExceptionDialog();
				this.primaryStage.close();
				compte=null;
			} catch (ApplicationException ae) {
				ExceptionDialog ed = new ExceptionDialog(this.primaryStage, this.dbs, ae);
				ed.doExceptionDialog();
				compte=null;
			}
		}
		return compte;
	}
 
//enregistremment du nouveau compte dans la base de donnée
	public void insertNewCompteCourant(double debitAutorise, double montant,int idNumClient)
			throws DatabaseConnexionException, ManagementRuleViolation, DataAccessException {
		try {
			Connection con = LogToDatabase.getConnexion();
			CallableStatement call;

			String q = "{call CreerCompte (?, ?, ?, ?)}";
			// les ? correspondent aux paramètres : cf. déf procédure (4 paramètres)
			call = con.prepareCall(q);
			// Paramètres in
			call.setDouble(1, debitAutorise);
			// 1 -> valeur du premier paramètre, cf. déf procédure
			call.setDouble(2, montant);
			call.setInt(3, idNumClient);
			// Paramètres out
			call.registerOutParameter(4, java.sql.Types.INTEGER);
			// 4 type du quatrième paramètre qui est déclaré en OUT, cf. déf procédure

			call.execute();

			int res = call.getInt(4);

			if (res < 0) { // Erreur applicative
				throw new ManagementRuleViolation(Table.CompteCourant, Order.INSERT,
						"Erreur de règle de gestion : Montant initiale trop petite ", null);
			}
		} catch (SQLException e) {
			throw new DataAccessException(Table.CompteCourant, Order.INSERT, "Erreur accès", e);
		}
	}
	
	

----

 
 













